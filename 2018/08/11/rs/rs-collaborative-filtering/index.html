<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="推荐系统：协同过滤算法"><meta name="keywords" content="协同过滤,推荐系统"><meta name="author" content="VinxC"><meta name="copyright" content="VinxC"><title>推荐系统：协同过滤算法 | VinxC's blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#协同过滤算法"><span class="toc-number">1.</span> <span class="toc-text">协同过滤算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基于用户的协同过滤算法"><span class="toc-number">2.</span> <span class="toc-text">基于用户的协同过滤算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#寻找偏好相似的用户"><span class="toc-number">2.1.</span> <span class="toc-text">寻找偏好相似的用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#相似性度量"><span class="toc-number">2.2.</span> <span class="toc-text">相似性度量</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#欧几里德距离评价"><span class="toc-number">2.2.1.</span> <span class="toc-text">欧几里德距离评价</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#皮尔逊相关度评价"><span class="toc-number">2.2.2.</span> <span class="toc-text">皮尔逊相关度评价</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#皮尔逊相关系数"><span class="toc-number">2.2.3.</span> <span class="toc-text">皮尔逊相关系数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#为相似的用户推荐物品"><span class="toc-number">2.3.</span> <span class="toc-text">为相似的用户推荐物品</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#为用户C推荐商品"><span class="toc-number">2.3.1.</span> <span class="toc-text">为用户C推荐商品</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#加权排序推荐"><span class="toc-number">2.3.2.</span> <span class="toc-text">加权排序推荐</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基于物品的协同过滤算法"><span class="toc-number">3.</span> <span class="toc-text">基于物品的协同过滤算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#寻找相似的物品"><span class="toc-number">3.1.</span> <span class="toc-text">寻找相似的物品</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#相似性度量（皮尔逊相关度评价）"><span class="toc-number">3.2.</span> <span class="toc-text">相似性度量（皮尔逊相关度评价）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#为用户提供基于相似物品的推荐"><span class="toc-number">3.3.</span> <span class="toc-text">为用户提供基于相似物品的推荐</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#加权排序推荐-1"><span class="toc-number">3.3.1.</span> <span class="toc-text">加权排序推荐</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://vinxikk.github.io/img/avatar.png"></div><div class="author-info__name text-center">VinxC</div><div class="author-info__description text-center">A Bigdata Developer</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">81</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">92</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">15</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="https://molunerfinn.com" target="_blank" rel="noopener">Molunerfinn</a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">VinxC's blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">推荐系统：协同过滤算法</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-08-11</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/">推荐系统</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">2.4k</span><span class="post-meta__separator">|</span><span>Reading time: 7 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h3 id="协同过滤算法"><a href="#协同过滤算法" class="headerlink" title="协同过滤算法"></a>协同过滤算法</h3><p>协同过滤算法是诞生最早，且较为著名的推荐算法，主要用于预测和推荐。</p>
<p>算法通过对用户历史行为数据的挖掘发现用户的偏好，基于不同的偏好对用户进行群组划分并推荐品味相似的商品。</p>
<p>协同过滤推荐算法分为两类：基于用户的协同过滤算法（user-based collaborative filtering），基于物品的协同过滤算法（item-based collaborative filtering）。</p>
<p>简单的说就是：人以群分，物以类聚。</p>
<h3 id="基于用户的协同过滤算法"><a href="#基于用户的协同过滤算法" class="headerlink" title="基于用户的协同过滤算法"></a>基于用户的协同过滤算法</h3><p>基于用户的协同过滤算法，是通过用户的历史行为数据发现用户对商品或内容的喜好（如商品购买、收藏、内容评论或分享等），并对这些喜好进行度量和打分，根据不同用户对相同商品或内容的态度和偏好程度计算用户之间的关系，最后在有相同喜好的用户间进行商品推荐。</p>
<p>简单的说就是，假如A、B两个用户都购买了x、y、z三本图书，并且都给出了5星的好评，那么就认为A和B属于同一类用户，可以将A看过的图书w也推荐给用户B。</p>
<p><img src="https://vinxikk.github.io/img/rs/user-based-cf.png" alt="基于用户的协同过滤"></p>
<h4 id="寻找偏好相似的用户"><a href="#寻找偏好相似的用户" class="headerlink" title="寻找偏好相似的用户"></a>寻找偏好相似的用户</h4><p>下面我们模拟5个用户对2件商品的评分，来说明如何通过用户对不同商品的态度和偏好寻找到相似的用户。</p>
<p><img src="https://vinxikk.github.io/img/rs/user-item-score.png" alt="用户对商品的评分"></p>
<p>在示例中，5个用户分别对两件商品进行了评分。这里的分值可以表现为真实的购买，也可以是用户对商品不同行为的量化指标。例如，浏览商品的次数，向朋友推荐商品，收藏，分享或评论等，这些行为都可以表示用户对商品的态度和偏好程度。</p>
<p>从表格中很难直观发现5个用户间的联系，我们将5个用户对2件商品的评分用散点图表示，用户间的关系就很容易发现了。</p>
<p><img src="https://vinxikk.github.io/img/rs/user-item-score-scatter.png" alt="用户间的关系"></p>
<p>在散点图中，X轴是商品1的评分，Y轴是商品2的评分。</p>
<p>通过用户的分布情况可以发现，A、C、D三个用户距离较近，即用户A(3.3, 6.5)和用户C(3.6, 6.3)、用户D(3.4, 5.8)对两件商品的评分较为接近，可以认为A、C、D三个用户属于同一类的用户。而用户B和E则形成了另一个群体。</p>
<p>散点图虽然直观，但无法投入实际的应用，也不能准确地度量用户间的关系。因此我们需要通过数字对用户间的关系进行准确的度量，并依据这些关系完成商品的推荐。</p>
<h4 id="相似性度量"><a href="#相似性度量" class="headerlink" title="相似性度量"></a>相似性度量</h4><h5 id="欧几里德距离评价"><a href="#欧几里德距离评价" class="headerlink" title="欧几里德距离评价"></a>欧几里德距离评价</h5><p>欧几里德距离评价是一个较为简单的用户关系评价方法，原理是通过计算两个用户在散点图中的距离来判断不同的用户是否有相同的偏好。</p>
<p><img src="https://vinxikk.github.io/img/rs/euclidean-distance.png" alt="欧氏距离计算公式"></p>
<p>我们获得了5个用户相互之间的欧几里德系数，也就是用户间的距离。系数越小表示两个用户间的距离越近，偏好也越是接近。不过这里有个问题，太小的数值可能无法准确地表现出不同用户间距离的差异，因此我们对求得的系数取倒数，使用户间的距离约接近，数值越大。</p>
<h5 id="皮尔逊相关度评价"><a href="#皮尔逊相关度评价" class="headerlink" title="皮尔逊相关度评价"></a>皮尔逊相关度评价</h5><p>皮尔逊相关度评价是另一种计算用户间关系的方法，他比欧几里德距离评价的计算要复杂一些，但对于评分数据不规范时，皮尔逊相关度评价能够给出更好的结果。</p>
<p>以下是多个用户对多件商品进行评分的示例，这个示例比之前的两件商品的情况要复杂一些，但也更接近真实的情况。</p>
<p>我们通过皮尔逊相关度评价对用户进行相似性度量和分组，并推荐商品。</p>
<p><img src="https://vinxikk.github.io/img/rs/user-item-score-2.png" alt="用户对多个商品的评分"></p>
<h5 id="皮尔逊相关系数"><a href="#皮尔逊相关系数" class="headerlink" title="皮尔逊相关系数"></a>皮尔逊相关系数</h5><p>皮尔逊相关系数的计算公式如下，结果是一个在-1与1之间的系数，该系数用来说明两个用户间联系的强弱程度。</p>
<p><img src="https://vinxikk.github.io/img/rs/pearson-correlation-coefficient.png" alt="皮尔逊相关系数计算公式"></p>
<p>相关系数的分类：</p>
<ul>
<li>0.8-1.0  极强相关</li>
<li>0.6-0.8  强相关</li>
<li>0.4-0.6  中等程度相关</li>
<li>0.2-0.4  弱相关</li>
<li>0.0-0.2  极弱相关或无相关</li>
</ul>
<p><img src="https://vinxikk.github.io/img/rs/user-pearson-correlation-coefficient.png" alt="用户间的相似度"></p>
<p>通过计算5个用户对5件商品的评分，我们获得了用户间的相似度数据，可以看到，用户A&amp;B，C&amp;D，C&amp;E和D&amp;E之间的相似度较高。下面，我们就可以按照相似度对用户进行商品推荐了。</p>
<h4 id="为相似的用户推荐物品"><a href="#为相似的用户推荐物品" class="headerlink" title="为相似的用户推荐物品"></a>为相似的用户推荐物品</h4><h5 id="为用户C推荐商品"><a href="#为用户C推荐商品" class="headerlink" title="为用户C推荐商品"></a>为用户C推荐商品</h5><p>当我们需要对用户C推荐商品时，首先检查之前的相似度列表，发现用户C和用户D、E的相似度较高。换句话说，这三个用户是同一类群体，拥有相同的偏好，因此，我们可以对用户C推荐D和E的商品。</p>
<p>但这里有一个问题，我们不能直接推荐前面商品1-5的商品，因为这些商品用户C已经浏览或者购买过了，不能重复推荐，因此我们要推荐用户C还没有浏览或购买过的商品。</p>
<h5 id="加权排序推荐"><a href="#加权排序推荐" class="headerlink" title="加权排序推荐"></a>加权排序推荐</h5><p>我们提取了用户D和用户E评价过的另外5件商品：商品A-F。并对不同商品的评分进行相似度加权，按加权后的结果对5件商品进行排序，然后推荐给用户C。这样，用户C就获得了与他偏好相似的用户D和E评价的商品。而在具体的推荐顺序和展示上我们按照用户D和E与用户C的相似度进行排序。</p>
<p><img src="https://vinxikk.github.io/img/rs/user-item-recommend.png" alt="为用户C推荐商品"></p>
<p>以上是基于用户的协同过滤算法，这个算法依靠用户的历史行为数据来计算相关度，也就是说，必须要有一定的数据积累（冷启动问题）。</p>
<p>对于新网站或数据量较少的网站，还有一种方法是基于物品的协同过滤算法。</p>
<h3 id="基于物品的协同过滤算法"><a href="#基于物品的协同过滤算法" class="headerlink" title="基于物品的协同过滤算法"></a>基于物品的协同过滤算法</h3><p>基于物品的协同过滤算法与基于用户的协同过滤算法很像，将商品和用户互换，通过计算不同用户对不同物品的评分获得物品间的关系，然后基于物品间的关系对用户进行相似物品的推荐。这里的评分代表用户对商品的态度和偏好。</p>
<p>简单来说就是，如果用户A同时购买了商品1和商品2，那么说明商品1和商品2的相关度较高。当用户B也购买了商品1时，可以推断他也有购买商品2的需求。</p>
<p><img src="https://vinxikk.github.io/img/rs/item-based-cf.png" alt="基于物品的协同过滤"></p>
<h4 id="寻找相似的物品"><a href="#寻找相似的物品" class="headerlink" title="寻找相似的物品"></a>寻找相似的物品</h4><p>表格中是两个用户对5件商品的评分。在这个表格中，用户和商品的位置进行了互换，通过两个用户的评分来获得5件商品之间的相似度情况。单从表格中我们依然很难发现其中的联系，因此我们选择通过散点图进行展示。</p>
<p><img src="https://vinxikk.github.io/img/rs/item-user-score.png" alt="商品的评分"></p>
<p>单从表格中我们依然很难发现其中的联系，因此我们选择通过散点图进行展示。</p>
<p><img src="https://vinxikk.github.io/img/rs/item-user-score-scatter.png" alt="物品间的关系"></p>
<p>在散点图中，X轴和Y轴分别是两个用户的评分，5件商品按照所获的评分值分布在散点图中。</p>
<p>我们可以发现，商品1, 3, 4在用户A和B中有着近似的评分，说明这三件商品的相关度较高，而商品5和2则在另一个群体中。</p>
<h4 id="相似性度量（皮尔逊相关度评价）"><a href="#相似性度量（皮尔逊相关度评价）" class="headerlink" title="相似性度量（皮尔逊相关度评价）"></a>相似性度量（皮尔逊相关度评价）</h4><p>我们选择使用皮尔逊相关度评价来计算多用户与多商品的关系，下面是5个用户对5件商品的评分表，我们通过这些评分计算出商品间的相关度。</p>
<p><img src="https://vinxikk.github.io/img/rs/item-user-score-2.png" alt="商品的评分表"></p>
<p>商品间的皮尔逊相关度：</p>
<p><img src="https://vinxikk.github.io/img/rs/item-pearson-correlation-coefficient.png" alt="物品间的相似度"></p>
<p>通过计算可以发现，商品1&amp;2，商品3&amp;4，商品3&amp;5和商品4&amp;5相似度较高，下一步我们可以依据这些商品间的相关度对用户进行商品推荐。</p>
<h4 id="为用户提供基于相似物品的推荐"><a href="#为用户提供基于相似物品的推荐" class="headerlink" title="为用户提供基于相似物品的推荐"></a>为用户提供基于相似物品的推荐</h4><p>这里我们遇到了和基于用户进行商品推荐相同的问题，当需要对用户C基于商品3推荐商品时，需要一张新的商品与已有商品间的相似度列表。在前面的相似度计算中，商品3与商品4和5相似度较高，因此我们计算并获得了商品4, 5与其他商品的相似度列表。</p>
<p><img src="https://vinxikk.github.io/img/rs/item-user-score-3.png" alt="其他商品评分表"></p>
<p><code>注意：这里的用户1, 2, 3原则上和上面的用户A-E不同</code></p>
<p>以下是通过计算获得的新商品与已有商品间的相似度数据。</p>
<p><img src="https://vinxikk.github.io/img/rs/new-item-pearson-correlation-coefficient.png" alt="新物品与已有物品间的相似度"></p>
<h5 id="加权排序推荐-1"><a href="#加权排序推荐-1" class="headerlink" title="加权排序推荐"></a>加权排序推荐</h5><p>这里是用户C已经购买过的商品4, 5与新商品A, B, C之间的相似程度。</p>
<p>我们将用户C对商品4, 5的评分作为权重，对商品A, B, C进行加权排序，用户C评分较高并且与之相似度较高的商品被优先推荐。</p>
<p><img src="https://vinxikk.github.io/img/rs/item-user-recommend.png" alt="为用户C推荐商品"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined" target="_blank" rel="noopener">VinxC</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="/https:/vinxikk.github.io/2018/08/11/rs/rs-collaborative-filtering/">https://vinxikk.github.io/2018/08/11/rs/rs-collaborative-filtering/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%8D%8F%E5%90%8C%E8%BF%87%E6%BB%A4/">协同过滤</a><a class="post-meta__tags" href="/tags/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/">推荐系统</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/01/21/datawarehouse/dw-scd/"><i class="fa fa-chevron-left">  </i><span>数据仓库：缓慢变化维度（SCD）</span></a></div><div class="next-post pull-right"><a href="/2018/08/10/spark/spark-window-function/"><span>Spark窗口函数</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2020 By VinxC</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>